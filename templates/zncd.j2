FROM {{ item.value.build_params.base_image[ansible_architecture] }}
RUN apk update;\
    apk add znc;\
    adduser -D zncDude -s /bin/ash ;
 

EXPOSE 5000

{% if item.value.build_params.has_key('vpn') and item.value.build_params.vpn == True %}
RUN apk add openvpn
COPY run_{{ item.key }}_with_vpn.sh /bin/run_{{ item.key }}_with_vpn.sh
ENTRYPOINT run_{{ item.key }}_with_vpn.sh

{% else %}
ENTRYPOINT {{ item.value.build_params.command }}
{% endif %}
